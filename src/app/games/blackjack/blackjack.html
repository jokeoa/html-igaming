<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Blackjack Game - HTML Casino</title>
    <link rel="stylesheet" href="../../../globals.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Geist:wght@100..900&display=swap"
      rel="stylesheet"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="blackjack.css" />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="../../../js/balance-manager.js"></script>
  </head>
  <body>
    <div class="layout-container">
      <!-- Header Navigation -->
      <header class="header">
        <nav class="navbar navbar-expand-lg navbar-dark py-2">
          <div class="container-fluid px-2 px-lg-3">
            <button class="btn sidebar-toggle-btn me-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas" aria-controls="sidebarOffcanvas">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
              </svg>
            </button>
            <a class="navbar-brand d-flex align-items-center" href="../../../../index.html">
              <span class="navbar-brand-text" style="font-family: 'Geist Mono', monospace; font-weight: 600; font-size: 1.25rem;">HTML igaming</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar" aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mainNavbar">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-2 ms-lg-3 gap-2 gap-lg-3">
                <li class="nav-item"><a class="nav-link" href="../../about/page.html">About</a></li>
                <li class="nav-item"><a class="nav-link" href="../../faq/page.html">FAQ</a></li>
              </ul>
              <div class="d-flex align-items-center gap-2">
                <div class="user-info d-none d-md-flex align-items-center gap-2 me-3">
                  <span class="text-white-50 small" id="userNameNav">Guest</span>
                  <span class="badge bg-success user-balance" id="userBalanceNav">$0.00</span>
                </div>
                <a href="../../user-profile/page.html" class="btn btn-outline btn-sm px-3 py-1">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="me-1">
                    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                    <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                  </svg>
                  Profile
                </a>
                <a href="https://github.com/jokeoa/html-casino" class="btn btn-outline btn-sm px-3 py-1">
                  <img src="../../../../public/GitHub.svg" alt="GitHub" class="me-1" style="height:16px;" />
                  GitHub
                </a>
                <a href="../../catalog/page.html" class="btn btn-primary btn-sm px-3 py-1">Play games</a>
              </div>
            </div>
          </div>
        </nav>
      </header>

      <!-- Sidebar Offcanvas -->
      <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarOffcanvas" aria-labelledby="sidebarOffcanvasLabel">
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="sidebarOffcanvasLabel">HTML igaming</h5>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
          <nav class="sidebar-nav">
            <div>
              <h3 class="sidebar-title">Quick Access</h3>
              <ul class="sidebar-menu">
                <li><a href="../../catalog/page.html" class="sidebar-link">All Games</a></li>
                <li><a href="../../game-page/page.html" class="sidebar-link">Blackjack</a></li>
                <li><a href="../../../../404.html" class="sidebar-link">Poker</a></li>
                <li><a href="../../game-page/roulette.html" class="sidebar-link">Roulette</a></li>
              </ul>
            </div>
            <div>
              <h3 class="sidebar-title">Information</h3>
              <ul class="sidebar-menu">
                <li><a href="../../about/page.html" class="sidebar-link">About Us</a></li>
                <li><a href="../../faq/page.html" class="sidebar-link">FAQ</a></li>
                <li><a href="../../user-policy/page.html" class="sidebar-link">User Policy</a></li>
              </ul>
            </div>
          </nav>
        </div>
      </div>

      <!-- Main Content -->
      <main class="main-content">
        <div class="container py-4">
          <!-- Game Header Card -->
          <div class="card mb-4 game-header-card">
            <div class="card-body text-center">
              <h1 class="display-4 mb-3 fw-bold">Blackjack</h1>
              <div class="d-flex justify-content-center align-items-center gap-3 flex-wrap">
                <div class="balance-info">
                  <span class="text-muted me-2">Balance:</span>
                  <span class="h4 mb-0 fw-bold text-success user-balance balance-amount" id="userBalance">$0.00</span>
                </div>
                <div class="user-info">
                  <span class="text-muted me-2">Player:</span>
                  <span class="h6 mb-0 fw-semibold" id="userNameDisplay">Guest User</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Game Message Alert -->
          <div id="gameMessage" class="alert alert-dismissible fade show d-none" role="alert">
            <span id="gameMessageText"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>

          <!-- Game Area Cards -->
          <div class="row g-4 mb-4">
            <!-- Dealer Card -->
            <div class="col-12">
              <div class="card dealer-card">
                <div class="card-header bg-transparent border-0 pb-2">
                  <h3 class="card-title mb-0">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                      <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                      <path d="M5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3z"/>
                    </svg>
                    Dealer
                  </h3>
                </div>
                <div class="card-body">
                  <div id="dealerCards" class="cards-container mb-3"></div>
                  <div id="dealerScore" class="score-display text-center"></div>
                </div>
              </div>
            </div>

            <!-- Player Card -->
            <div class="col-12">
              <div class="card player-card">
                <div class="card-header bg-transparent border-0 pb-2">
                  <h3 class="card-title mb-0">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                      <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                      <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                    </svg>
                    Player
                  </h3>
                </div>
                <div class="card-body">
                  <div id="playerCards" class="cards-container mb-3"></div>
                  <div id="playerScore" class="score-display text-center"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>

      <!-- Game Controls Hotbar -->
      <div class="hotbar">
        <div class="container">
          <div class="hotbar-content">
            <!-- Bet Stage -->
            <div id="betStage" class="w-100 d-block">
              <div class="card bet-control-card">
                <div class="card-body">
                  <h5 class="card-title text-center mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                      <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
                      <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
                    </svg>
                    Place Your Bet
                  </h5>
                  <div class="row justify-content-center">
                    <div class="col-12 col-md-8 col-lg-6">
                      <label for="betAmount" class="form-label fw-semibold mb-3">Bet Amount</label>
                      <div class="input-group input-group-lg mb-3">
                        <span class="input-group-text">$</span>
                        <input type="number" id="betAmount" class="form-control text-center" value="10" min="1" step="1" max="1000" placeholder="Enter amount">
                      </div>
                      <div class="d-flex flex-wrap gap-2 justify-content-center mb-3">
                        <button type="button" class="btn btn-outline-primary bet-quick-btn" data-amount="10">$10</button>
                        <button type="button" class="btn btn-outline-primary bet-quick-btn" data-amount="50">$50</button>
                        <button type="button" class="btn btn-outline-primary bet-quick-btn" data-amount="100">$100</button>
                        <button type="button" class="btn btn-outline-primary bet-quick-btn" data-amount="500">$500</button>
                      </div>
                      <div class="d-grid">
                        <button id="placeBetBtn" class="btn btn-gradient btn-lg">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                            <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                            <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                          </svg>
                          Place Bet & Start Game
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Game Stage -->
            <div id="gameStage" class="w-100 d-none">
              <div class="card game-control-card">
                <div class="card-body">
                  <div class="d-flex flex-wrap gap-3 justify-content-center">
                    <button id="hitBtn" class="btn btn-gradient btn-lg">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                      </svg>
                      Hit
                    </button>
                    <button id="standBtn" class="btn btn-outline btn-lg">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                        <path fill-rule="evenodd" d="M14 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                        <path fill-rule="evenodd" d="M3.5 6.5A.5.5 0 0 1 4 7h8a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.5-.5zm0 2A.5.5 0 0 1 4 10h8a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.5-.5z"/>
                      </svg>
                      Stand
                    </button>
                    <button id="splitBtn" class="btn btn-outline btn-lg" style="display: none;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M3 5.5A1.5 1.5 0 0 1 4.5 4h7A1.5 1.5 0 0 1 13 5.5v5A1.5 1.5 0 0 1 11.5 12h-7A1.5 1.5 0 0 1 3 10.5v-5zM4.5 5a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-7z"/>
                      </svg>
                      Split
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Post Game Stage -->
            <div id="postGameStage" class="w-100 d-none">
              <div class="card post-game-card">
                <div class="card-body">
                  <div class="d-flex flex-wrap gap-3 justify-content-center">
                    <button id="playAgainBtn" class="btn btn-gradient btn-lg">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                        <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                        <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                      </svg>
                      Play Again
                    </button>
                    <a href="../../catalog/page.html" class="btn btn-outline btn-lg">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16" class="me-2">
                        <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
                      </svg>
                      Back to Games
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <footer class="footer">
        <div class="footer-content">
          <div class="footer-top">
            <div class="footer-logo">
              <a href="../../../../index.html" style="text-decoration: none;">
                <span style="font-family: 'Geist Mono', monospace; font-weight: 600; font-size: 1.25rem;">HTML igaming</span>
              </a>
            </div>
            <a href="../../catalog/page.html" class="btn btn-gradient">Play games</a>
          </div>
          <div class="footer-bottom">
            <nav class="footer-links">
              <a href="../../../../index.html" class="footer-link">Main</a>
              <a href="../../about/page.html" class="footer-link">About</a>
              <a href="../../user-policy/page.html" class="footer-link">User policy</a>
              <a href="../../faq/page.html" class="footer-link">FAQ</a>
              <a href="../../catalog/page.html" class="footer-link">Games</a>
              <a href="../../sitemap/page.html" class="footer-link">Site map</a>
            </nav>
            <p class="footer-description">
              Made by Yandex Gophers team: Madiyar Sarbayev, Vladislav Kutsenko,
              Amir Alenov, and Bekdaulet Bolatov for Web Technologies 1 course.
              This project was created for educational purposes by the student
              team at Astana IT University.
            </p>
          </div>
        </div>
      </footer>
    </div>

    <!-- Toast Notification Container -->
    <div id="toastNotification" class="toast-notification">
      <div class="toast-header">
        <span class="toast-title" id="toastTitle"></span>
        <button class="toast-close" id="toastClose">&times;</button>
      </div>
      <div class="toast-message" id="toastMessage"></div>
    </div>

    <!-- Theme Switcher Button -->
    <div class="theme-switcher">
      <button class="theme-btn" onclick="changeTheme()" title="Change Theme">
        ðŸŽ¨
      </button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="blackjack.js"></script>
    <script>
      // Initialize user info display
      $(document).ready(function() {
        if (typeof BalanceManager !== 'undefined') {
          // Get current balance
          const balance = BalanceManager.getBalance() || 0;
          const balanceFormatted = '$' + balance.toFixed(2);
          
          // Update balance displays - multiple methods for reliability
          BalanceManager.updateBalanceDisplay();
          
          // Explicitly update balance elements
          $('#userBalance').text(balanceFormatted);
          $('.user-balance').text(balanceFormatted);
          $('#userBalanceNav').text(balanceFormatted);
          
          // Update user name displays
          const userName = BalanceManager.getUserName() || 'Guest User';
          $('#userNameNav').text(userName);
          $('#userNameDisplay').text(userName);
          
          // Force update after a short delay to ensure DOM is ready
          setTimeout(function() {
            const currentBalance = BalanceManager.getBalance() || 0;
            const currentBalanceFormatted = '$' + currentBalance.toFixed(2);
            $('#userBalance').text(currentBalanceFormatted);
            $('.user-balance').text(currentBalanceFormatted);
            $('#userBalanceNav').text(currentBalanceFormatted);
            BalanceManager.updateBalanceDisplay();
          }, 100);
        }
      });
    </script>
  </body>
</html>
